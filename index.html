<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>
  <div>
    <h1>开心</h1>
    <p>是真的</p>
    <button id="btn1">下载HTML</button>
    <button id="btn2">下载XLS</button>
    <a href="http://localhost:3000/getHTML"> <button>a</button> </a>
    <a href="http://localhost:3000/getHTML" download="bb.html"><button>a + download</button></a>
  </div>


  <script>
    btn1.onclick = function () {
      let xhr = new XMLHttpRequest();
      xhr.open('GET', '/getHTML');
      xhr.send();
      xhr.onreadystatechange = function () {
        if (xhr.readyState === 4 && xhr.status === 200) {
          var data = xhr.responseText
          var blob = new Blob([data], {type: 'text/html;charset=utf-8'});
            console.log(blob)
          var reader = new FileReader();
          reader.addEventListener('load', function() {
            var a = document.createElement('a');
            a.download = 'aaa.html';
            console.log(reader.result)
            a.href = reader.result;
            a.click();
          })
          reader.readAsDataURL(blob);
        }
      }
    }
    btn2.onclick = function () {
      let xhr = new XMLHttpRequest();
      xhr.open('GET', '/getXLS');
      xhr.send();
      xhr.onreadystatechange = function () {
        if (xhr.readyState === 4 && xhr.status === 200) {
          var data = xhr.responseText
          var blob = new Blob([data], {type: 'application/vnd.ms-excel;charset=utf-8'});
            console.log(blob)
          var reader = new FileReader();
          reader.addEventListener('load', function() {
            var a = document.createElement('a');
            a.download = 'aaa.xls';
            console.log(reader.result)
            a.href = reader.result;
            a.click();
          })
          reader.readAsDataURL(blob);
        }
      }
    }


  </script>
</body>

</html>